
-- ---------------------------------------------------------
-- تشغيل هذا السكريبت في Supabase SQL Editor
-- الغرض: إضافة دعم تقسيم الموظفين (مكتب / مصنع)
-- ---------------------------------------------------------

-- 1. إضافة عمود "الفرع" (branch) إلى جدول الموظفين إذا لم يكن موجوداً
-- القيمة الافتراضية هي 'office' لضمان عمل النظام مع الموظفين الحاليين
ALTER TABLE public.employees 
ADD COLUMN IF NOT EXISTS branch text DEFAULT 'office';

-- 2. تحديث السجلات القديمة (في حال وجودها) لتعيين الفرع إلى 'office' بدلاً من null
UPDATE public.employees 
SET branch = 'office' 
WHERE branch IS NULL;

-- تم التحديث بنجاح. الآن يمكنك تحديد الفرع عند إضافة أو تعديل الموظفين.
